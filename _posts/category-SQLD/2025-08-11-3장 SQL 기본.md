---
title: "3장 SQL 기본"
excerpt: "SQL을 사용하는 기본적인 방법과 조인, 계층형 쿼리, 서브쿼리, 그룹 함수, 윈도우 함수 등을 학습한다."

wirter: sohee Kim
categories:
  - SQLD
tags:
  - SQLD

toc: true
toc_sticky: true

date: 2025-08-06
last_modified_at: 2025-08-08
---

SQL 기본
=======

관계형 데이터베이스(Relation)
------

&ensp;1. 관계형 데이터베이스(Relation Database)<br/>
&ensp;(1) 관계형 데이터베이스의 등장<br/>
* 관계형 데이터베이스는 릴레이션(Relation)과 릴레이션의 조인 연산을 통해서 합집합, 교집합,차집합 등을 만들 수 있다.
* 현재 기업에서 가장 많이 사용하는 데이터베이스로 Oracle, MS-SQL. MySQL, Sybase 등의 다양한 데이터베이스 관리 시스템이 있다.

&ensp;2. 데이터베이스와 데이터베이스 관리 시스템의 차이점<br/>
* 데이터베이스는 데이터를 어떠한 형태의 자료구조(Data Structure)로 사용하느냐에 따라서 나누어진다.
* 데이터베이스의 종류는 계층형, 네트워크형 데이터베이스, 관계형 데이터베이스 등이 있다.
* 게층형 데이터베이스는 트리(Tree) 형태의 자료구조에 데이터를 저장하고 관리하며 네트워크는 오너(Owner)와 멤버(Member) 형태로 데이터를 저장한다.
* 계층형 데이터베이스는 1대N 관계를 표현한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-1.JPEG" width="600"></p>

* 네트워크 데이터베이스는 1대N과 함께 M대N 표현도 가능하다

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-2.JPEG" width="600"></p>

* 관계형 데이터베이스는 릴레이션에 데이터를 저장하고 관리한다.
* 관계형 데이터베이스는 릴레이션을 사용해서 집합 연산과 관계 연산을 할 수 있다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-3.JPEG" width="600"></p>

* 데이터베이스 관리 시스템(Database Management System)은 계층형 데이터베이스, 네트워크 데이터베이스, 관계형 데이터베이스 등을 관리하기 위한 소프트웨어를 의미하며 일명 DBMS라고 한다.
* DBMS의 종류에는 Oracle, MS-SQL. MySQL, Sybase 등이 있으며 모두 관계형 데이터베이스를 지원한다.

&ensp;(3) 관계형 데이터베이스 집합 연산과 관계 연산<br/>

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-4.JPEG" width="600"></p>
<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-5.JPEG" width="600"></p>

&ensp;2. 테이블(Table)의 구조<br/>
* 관계형 데이터베이스는 릴레이션에 데이터를 저장하고 릴레이션을 사용해서 집합 연산 및 관계 연산을 지원하여 다양한 형태로 데이터를 조회할 수 있다.
* 릴레이션은 최종적으로 데이터베이스 관리 시스템에서 테이블(Table)로 만들어진다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-6.JPEG" width="600"></p>

* 기본키(Primary key)는 하나의 테이블에서 유일성(Unique)과 최소성, Not Null을 만족하면서 해당 테이블을 대표하는 것이다. EMP테이블에서는 사원번호가 기본키가 된다.
* 테이블은 행과 칼럼으로 구성된다. 그중에서 행(ROW)은 하나의 테이블에 저장되는 값으로 튜플(Tuple)이라고도 한다.
* 칼럼(Column)은 어떤 데이터를 저장하기 위한 필드(Field)로 속성(Attribute)이라고 한다.
* 외래키(Foreign key)는 다른 테이블의 기본키를 참조(조인)하는 칼럼이다. 예를 들어 EMP 테이블의 부서코드는 DEPT 테이블의 기본키인 부서코드를 참조한다.
* 외래키는 관계 연산 중에서 결합 연산(Join)을 하기 위해서 사용한다.

SQL(Structured Query Language) 종류
------

&ensp;1. SQL(Structured Query Language)<br/>
* SQL은 관계형 데이터베이스에 대해서 데이터의 구조를 정의, 데이터 조작, 데이터 제어 등을 할 수 있는 절차형 언어이다.
* 관계형 데이터베이스는 데이터베이스를 연결하고 SQL문을 사용하여 데이터베이스를 누구나 쉽게 사용할 수 있도록 한다.
* SQL은 ANSI/ISO 표준을 준수하기 때문에 데이터베이스 관리 시스템이 벼경되어도 그대로 사용할 수 있다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-7.JPEG" width="600"></p>

&ensp;2. SQL(Structured Query Language) 종류<br/>
* SQL은 데이터 정의, 데이터 조작, 데이터 제어 등의 기능을 지원한다.

&ensp;(1) SQL의 종류<br/>
<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-8.JPEG" width="600"></p>

* DDL문은 데이터베이스 테이블을 생성하거나 변경, 삭제하는 것으로 데이터를 저장할 구조를 정의하는 언어이다.
* DML은 데이터 구조가 DDL로 정의되면 해당 데이터 구조에 데이터를 입력하거나 수정, 삭제, 조회할 수 있다.
* DCL은 DDL로 정의된 구조에 어떤 사용자가 접근할 수 있는지 권한을 부여하는 것이다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-9.JPEG" width="600"></p>

* 작업의 순서를 보면 데이터베이스의 사용자에게 권한을 부여하고 권한이 부여되면 DDL로 데이터 구조를 정의한다.
* 데이터 구조가 정의되면 데이터를 입력한 후에 개발자 및 사용자가 그 데이터를 조회하는 것이다.

&ensp;(2) 트랜잭션(Transaction)<br/>
<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-10.JPEG" width="600"></p>

&ensp;3. SQL문의 실행 순선<br/>
* 개발자가 작성한 SQL(DDL, DML, DCL 등)은 3단계를 걸쳐서 실행된다. SQL문의 문법을 거사하고 구문 분석을 한다.
* 구분 분석 이후에 SQL을 실행한다. SQL이 실행되면 데이터를 인출하게 된다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-11.JPEG" width="600"></p>

DDL(Data Definition Language)
-------

&ensp;1. 테이블(Table) 생성<br/>
* 데이터베이스를 사용하기 위해서는 테이블을 먼저 생성해야 한다.
* 테입르 생성은 Create Table문을 사용하고 테이블 변경은 Alter Table문을 사용한다. 마지막으로 생성된 테이블을 삭제하고 싶을 때는 Drop Table문을 사용하면 된다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-12.JPEG" width="600"></p>

&ensp;(1) 기본적인 테이블 생성<br/>
* 테이블을 생성하는 방법은 여러 가지가 있다. 먼저 아주 간단한 테이블 생성 방법을 확인해보자

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-13.JPEG" width="600"></p>
<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-14.JPEG" width="600"></p>

&ensp;(2) 제약조건 사용<br/>
* 기본키, 외래키, 기본값, not null 등은 테이블을 생성할 때 지정할 수 있다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-15.JPEG" width="600"></p>

* 위의 예를 보면 "constraint" 를 사용하여 기본키(empno)와 기본키의 이름(empppk)을 지정할 수 있다.
* 만약 위의 예에서 두 개의 기본키를 지정하고자 한다면 "constraint emppk primary key(empno, ename)"으로 지정하면 된다.
* sal 칼럼은 number(10, 2)로 지정했다. 이것은 소수점 둘째 자리까지 저장하게 된다.
* Oracle 데이터베이스에서 "sydate"는 오늘의 날짜를 조회한다. 이를 default 옵셥을 사용해서 오늘 날짜를 기본값으로 지정할 수 있다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-16.JPEG" width="600"></p>

* 외래키(foreign key)를 지정하려면 먼저 마스터 테이블이 생성되어야 한다. 즉 사원과 부서 테이블에서는 부서가 마스터 테이블이 된다.
* 즉 사원 테이블이 부서 테이블의 deptno를 참조해야 하는 것이다.
* 그리고 EMP 테이블을 생성할 때 constraint를 사용하여 외래키 이름인 "deptfk"를 입력 후 외래키를 생성한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-17.JPEG" width="600"></p>

&ensp;(3) 테이블 생성 시 CASCADE 사용<br/>
* 테이블을 생성할 때 CASCADE 옵션을 사용할 수 있다. CASCADE 옵션은 참조 관계(기본키와 외래키 관계)가 있을 경우 참조되는 데이터를 자동으로 반영할 수 있는 것이다.
* 먼저 마스터 테이블을 생성한다. 즉 DEPT 테이블을 생성하고 데이터를 입력한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-18.JPEG" width="600"></p>

* 그 다음 EMP 테이블을 생성하고 데이터를 입력한다. 단 EMP 테이블을 생성할 때 "ON DELETE CASCADE" 옵션을 사용한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-19.JPEG" width="600"></p>

* EMP 테이블을 생성하고 데이터 두 개를 입력한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-20.JPEG" width="600"></p>

* 위의 예제를 보면 DEPT 테이블에서 DEPTNO가 '1000번' 인 인사팀을 삭제한다.
* 그리고 EMP 테이블의 데이터를 조회한 결과 DEPTNO '1000'번이였던 '임베스트' 데이터도 자동으로 삭제된 것을 알 수 있다.
* 즉 ON DELETE CASCADE 옵션은 자신이 참조하고 있는 테이블(DEPT)의 데이터가 삭제되면 자동으로 자신(EMP)도 삭제되는 옵션이다.
* ON DELETE CASCADE 옵션을 사용하면 참조 무결성을 준수할 수 없다. 참조 무결성이란 마스터 테이블(DEPT)에는 해당 부서번호(DEPTNO)가 없는데 슬레이브 테이블(EMP)에는 해당 부서번호가 있는 경우를 참조 무결성 위배로 볼 수 있다.

&ensp;2. 테이블(Table) 변경<br/>
* ALTER TABLE문을 통해 테이블 변경을 할 수 있으며 테이블명 변경, 칼럼 추가, 변경, 삭제 등을 할 수 있다.

&ensp;(1) 테이블명 변경<br/>
* 테이블명 변경은 ALTER TABLE ~ RENAME TO문을 사용하면 된다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-21.JPEG" width="600"></p>

&ensp;(2) 칼럼 추가<br/>
* 생성된 EMP 테이블에 ALTER TABLE ~ ADD문을 사용해서 칼럼을 추가한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-22.JPEG" width="600"></p>

&ensp;(3) 칼럼 변경<br/>
* 칼럼의 변경은 ALTER TABLE ~ MODIFY문을 사용하면 된다. 칼럼 변경을 통해 데이터 타입으르 변경하거나 데이터의 길이를 변경할 수 있다.
* 칼럼을 변경할 때 제약조건을 설정할 수도 있다.
* 칼럼의 데이터 타입을 변경할 때 기존 데이터가 있는 경우 에러가 발생한다. 예를 들어 숫자 타입이고 숫자 데이터가 저장되어 있는데 문자형 데이터 타입으로 변경하면 에러가 발생하는 것이다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-23.JPEG" width="600"></p>

&ensp;(4)칼럼 삭제<br/>
* 칼럼에 대한 삭제는 ALTER TABLE ~ DROP COLUMN문으로 삭제한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-24.JPEG" width="600"></p>

&ensp;(5) 칼럼명 변경<br/>
* 칼럼명 변경은 ALTER TABLE ~ RENAME COLUMN ~ TO 문으로 변경할 수 있다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-25.JPEG" width="600"></p>

&ensp;3. 테이블(Table) 삭제<br/>
* 테이블 삭제는 DROP TABLE문을 사용해서 삭제할 수 있다.
* DROP TABLE문은 테이블의 구조와 테이블를 모두 삭제한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-26.JPEG" width="600"></p>

* DROP TABLE에서 CASECADE CONSTRAINT 옵션을 사용할 수 있다. CASCADE CONSTRAINT 옵션은 해당 테이블의 데이터를 외래키로 참조한 슬레이브 테이블과 관련된 제약사항도 삭제할 때 사용한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-27.JPEG" width="600"></p>

&ensp;4. 뷰(View)생성과 삭제<br/>
* 뷰는 테이블로부터 유도된 가상의 테이블이다.
* 실제 데이터를 가지고 있지 않고 테이블을 참조해서 원하는 칼럼만을 조회할 수 있게 한다. 
* 뷰는 데이터 딕셔너리(Data Dictionary)에 SQL문을 형태로 저장하되 실행 시에 참조된다.

* 뷰의 특징<br/>
  - 참조한 테이블이 변경되면 뷰도 변경된다.
  -  뷰의 검색은 참조한 테입르과 동일하게 할 수 있지만 뷰에 대한 입력, 수정, 삭제엔느 제약이 있다.
  - 특정 칼럼만 조회시키는 보안성을 향상시킨다.
  - 한번 생성된 뷰는 변경할 수 없고 변경을 원하면 삭제 후 재생성해야 한다.
  - ALTER문을 사용해서 뷰를 변경할 수 없다.

* 뷰를 생성할 때 CREATE VIEW문을 사용하며 이 때 참조할 테이블은 SELECT문으로 지정한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-28.JPEG" width="600"></p>

* 뷰의 조회는 SELECT문을 사용해서 일반 테이블처럼 조회한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-29.JPEG" width="600"></p>

* 뷰의 삭제는 DROP VIEW를 사용한다. 뷰를 삭제했다고 해서 참조했던 테이블이 삭제되지는 않는다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-30.JPEG" width="600"></p>
<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-31.JPEG" width="600"></p>

&ensp;4. DML(Data Manipulation Language)<br/>
&ensp;(1) INSERT문<br/>
* INSERT문은 테이블에 데이터를 입력하는 DML문이다.

* INSERT문

```sql
INSERT INTO data(column1, column2,...)VALUES(expression1, expression2);
```

* EMP 테이블에 데이터를 삽입하려면 테이블명, 칼럼명, 데이터 순으로 입력하면 된다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-32.JPEG" width="600"></p>

* 데이터를 입려할 때 문자열을 입력하는 경우에는 작음 따옴표(' ')를 사용해야 한다.
* 만약 특정 테이블의 모든 칼럼에 대한 데이터를 삽입하는 경우에는 칼럼명을 생략할 수 있다.
* 모든 칼럼에 데이터를 입력한다.

```sql
INSERT INTO EMP VALUES(1000, '임베스트');
```

* 위의 예처럼 칼럼명을 생략할 수 있다. 단 위의 예제에서 EMP 테이블의 칼럼은 숫자형 데이터 타입 한 개의 칼럼과 문자형 데이터 타입 한 개의 칼럼만 있어야 한다.
* 주의사항은 INSERT문을 실행했다고 데이터 파일에 저장되는 것은 아니다. 최종적으로 데이터를 저장하려면 TCL문인 Commit을 실행해야 한다.
* 만약 Auto Commit(Set auto commit on)으로 설정된 경우에는 Commit을 실행하지 않아도 바로 저장된다.

&ensp;(2)SELECT문으로 입력<br/>
* SELECT문을 사용하여 데이터를 조회해서 해당 테이블에 바로 삽입할 수 있다.
* 단 입력되는 테이블은 사전에 생성되어 있어야 한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-33.JPEG" width="600"></p>

&ensp;(3)Nologging 사용<br/>
* 데이터베이스에 데이터를 입력하면 로그파일(Log file)에 그 정보를 기록한다.
* Check point라는 이벤트가 발생하면 로그파일의 데이터를 데이터 파일에 저장한다.
* Nologging 옵션은 로그파일의 기록을 최소화시켜서 입력 시 성능을 향상시키는 방법이다.
* Nologging 옵션은 Buffer Cache라는 메모리 영역을 생략하고 기록한다.

<p align="center"><img src="/assets/img/SQLD/3. SQL 기본 및 활용/3-34.JPEG" width="600"></p>