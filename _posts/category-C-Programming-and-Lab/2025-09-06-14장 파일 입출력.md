---
title: "14장 파일 입출력"
excerpt: "파일의 개념을 이해한다."

wirter: sohee Kim
categories:
  - C Programming and Lab
tags:
  - C

toc: true
toc_sticky: true

date: 2025-09-06
last_modified_at: 2025-09-06
---

파일의 입출력 개요
======

&ensp;지금까지 사용한 입출력 방식<br/>
* 키보드(표준입력장치)를 통해 데이터를 입력하고 모니터(표준출력장치)로 결과 출력
* 프로그램 실행할 때마다 매번 입력해야 하고 결과는 프로그램ㅇ르 종료하면 사라짐

&ensp;프로그램의 실행/종료 여부와 무관하게 데이터를 보존하고 싶다.<br/>
* 데이터를 파일로부터 입력받고 결과를 파일로 저장(파일 입출력)

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-1.png" width="600"></p>

&ensp;저장된 데이터 형식에 따른 파일 종류<br/>
* 텍스트 파일
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-2.png" width="600"></p>

* 이진 파일
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-3.png" width="600"></p>

&ensp;텍스트 파일과 이진 파일 비교<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-4.png" width="600"></p>

&ensp;파일(텍스트)과 화면 출력 비교<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-5.png" width="600"></p>

파일 입출력 따라 해보기
=====

&ensp;input.dat 파일로부터 키, 몸무게, 나이 정보를 입력받아 -> 이 내용을 그대로 output.dat 파일에 출력하기<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-6.png" width="600"></p>

&ensp;input.dat 파일로부터 키, 몸무게, 나이 정보를 입력받아->이 내용을 그대로 output.dat 파일에 출력하기<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-7.png" width="600"></p>

```c
double height, weight;
int age, i;
FILE *fp1, *fp2; // FILE 구조체 포인터 선언

fp1 = fopen("input.dat", "r"); // input.dat 파일 열기
fp2 = fopen("output.dat", "w"); // output.dat 파일 열기
for (i = 0; i < 3; i++) {
fscanf(fp1, "%lf %lf %d", &height, &weight, &age); // 입력
fprintf(fp2, "%.2f %.2f %d\n", height, weight, age); // 출력
}

fclose(fp1); // input.dat 파일 닫기
fclose(fp2); // output.dat 파일 닫기
```

* 입출력은 유사

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-8.png" width="600"></p>

* 파일을 열고 닫는 과정 필요

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-9.png" width="600"></p>

&ensp;입력 파일과 출력 파일은 어느 폴더에?<br/>
* 파일의 위치는 현재 작업 폴더 기준
* 작업 폴더란? 작업이 이루어지는 폴더
    - VS에서 실행하는 경우네는 프로젝트 폴더
    - 앞의 예제를 실행해서 확인해보자
    - 실행파일이 위치한 폴더
    - CMD모드에서 확인해보자(다음 슬라이드)

&ensp;CMD (명령프롬프트)<br/>
* 일종의 text기반 사용자 interface(명령창에서 cmd실행)
* 폴더 경로 및 파일 확인해보기
* 기본 명령어
    - cd: 폴더 이동을 위한 명령어(cd 경로이름, cd \, cd...)
    - dir: 폴더의 파일 목록을 보여주는 명령어(dir/w)
    - 탐색기와 비슷한 역할
* CMD에서 앞 예제 프로그램의 실행 파일을 실행시켜보자.

파일 입출력 절차
=====

* 어떤 파일에 입출력할 지에 대한 명시 필요
* 필요한 자료형 및 함수는 <stdio.h>에 선언

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-10.png" width="600"></p>

&ensp;FILE 포인터 선언<br/>
* FILE은 파일 입출력 시 필요한 정보를 담은 구조체
* 파일 입출력 시 각 파일마다 하나의 FILE포인터를 연결하여 사용
* 선언 형식

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-11.png" width="600"></p>

&ensp;표준 스트림<br/>
* 표준 입출력 장치(키보드, 모니터)도 논리적으로 파일로 간주하여 처리
* 표준 스트림에 대한 FILE포인트 명(정해져 있음)
* 별도로 열거나 닫을 필요 없음(자동 수행)

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-12.png" width="600"></p>

&ensp;파일 열기: fopen() 함수<br/>
* 해당 파일에 대한 연결 요청을 의미
* 해당 파일을 사용할 수 있도록 파일 포인터를 반환

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-13.png" width="600"></p>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-14.png" width="600"></p>

&ensp;함수 인지 filename<br/>
* 해당 파일의 위치와 이름 명시
* 위치는 상대경로 또는 절대경로 표현
    - 예) fopen("test.txt", "r");
    - 예) fopen("C:\\MY\\DATA\\test.txt", "a");
    - 예) fopen("..\\DATA\\test.txt", "w"); 
* 경로에서 역슬래쉬 \를 표현하기 위해 \\을 사용

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-15.png" width="600"></p>

* 절대경로
    - 드라이브 명부터 해당 파일이 있는 위치까지 전체 경로
    - 예) C:\MY\DATA\test.txt
    - Unix 또는 Linux에서는 \ 대신 / 사용
* 상대경로
    - 현재 작업 폴더를 기준으로 해당 파일이 있는 위치까지의 경로
    - 예) DATA\test.txt (현재 작업 폴더가 MY 인 경우) 
    - 예) ..\DATA\test.txt (현재 작업 폴더가 SRC 인 경우)
    - ..은 상위폴더를 의미

* 개방할 파일의 용도에 따라 적합하게 지정해야 함
    - 적합한 모드 지정은 파일을 잘못 사용하는 것을 막을 수 있음

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-16.png" width="600"></p>

&ensp;'+' 기호를 붙이면 (예: r+, w+, ab+ 등) 수정 모드(읽기 쓰기 모두 가능)

&ensp;fopen() 함수 사용 시 주의사항<br/>
* fopen() 함수 호출 시 이 함수의 반환 값을 반드시 검사하여 파일이 정상적으로 열렸는지 확인해야 함

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-17.png" width="600"></p>

&ensp;파일 입출력 함수<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-18.png" width="600"></p>

&ensp;파일 닫기 : fclose() 함수<br/>
* 현재 열린 파일과 FILE포인터와의 연결을 해제

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-19.png" width="600"></p>

텍스트 파일 입출력
=====

&ensp;지정 형식 파일 입력 함수: fscanf()<br/>
* 데이터를 지정한 형식으로 데이터를 읽어 오는 함수
* 여러 형태의 자료들(정수, 문자, 문자열 등)을 한번에 입력 가능
* 함수의 첫 번째 인자로 파일 포인터가 사용된다는 것을 제외하고는 scanf() 함수와 사용법 동일

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-20.png" width="600"></p>

&ensp;fscanf() 함수 사용 예<br/>

```c
char name[10] = {'\0'};
double weight;
int age;

FILE *fp = fopen("input.dat", "r");

fscanf(fp, "%s %d %lf", name, &age, &weight);
    // input.dat 파일로부터 데이터를 입력받음
fscanf(stdin, "%s %d %lf", name, &age, &weight);
    // 키보드로부터 데이터를 입력받음
...
```

&ensp;첫 번째 인자를 stdin으로 지정하면 표준입력으로부터 입력(scanf() 함수를 사용한 것과 동일한 기능)<br/>

&ensp;지정 형식 파일 출력 함수: fprintf()<br/>

* 지정한 형식에 맞추어 파일로 출력 
* 함수의 첫 번째 인자로 파일 포인터가 사용된다는 것을 제외하고는 printf() 함수와 사용법 동일

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-21.png" width="600"></p>

&ensp;fprintf() 함수 사용 예<br/>

```c
char name[10] = "Tommy";
double weight = 78.45;
int age = 25;

FILE *fp = fopen("output.dat", "w");

fprintf(fp, "%s %d %.2lf", name, age, weight);
        // output.dat 파일로 데이터를 출력

fprintf(stdout, "%s %d %.2lf", name, age, weight);
        // 모니터로 데이터를 출력...
```

&ensp;문자 단위 파일 입출력 함수: fgetc() 와 fputc()<br/>
* 문자 한 개를 파일로부터 읽고 쓰기 위한 함수

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-22.png" width="600"></p>

&ensp;'x'가 입력될때까지 문자를 반복적으로 입력 받아 example.txt 파일에 문자 단위로 출력, example.txt 파일의 내용을 화면에 문자 단위로 출력<br/>

```c
char fn[] = "example.txt";
FILE *fp = fopen(fn, "w"); // 출력 파일 열기
...
ch = getchar(); // 문자 하나를 표준입력으로 입력
while (ch != 'x') { // 'x'가 입력될 때까지 반복
fputc(ch, fp); // 출력 파일로 문자 한 개 출력
ch = getchar(); // 키보드로부터 문자 한 개를 입력
}
fclose(fp); // 출력 파일 닫기
...
fp = fopen(fn, "r"); // 입력 파일 열기
...
ch = fgetc(fp); // 입력파일에서 문자 한 개 읽음
while (!feof(fp)) { // 파일의 끝까지 반복 (추후 학습)
putchar(ch); // 읽은 문자를 모니터로 출력
ch = fgetc(fp); // 입력파일에서 문자 한 개 읽음
}
fclose(fp); // 입력 파일 닫기
```

&ensp;문자열 단위의 파일 입력 함수: fgets( )<br/>
* 파일에 쓰여진 문자열을 읽는데 사용하는 함수

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-23.png" width="600"></p>

&ensp;fgets()의 기능<br/>
* 다음 조건이 만족될 때까지 파일 fp로 부터 문자를 읽어서 s가 가리키는 곳에 저장
    - n-1개의 문자(공백, 탭 문자 포함)를 읽거나
    - 개행 문자를 만나거나
    - 파일의 끝에 도달
* 문자열 마지막에 널 문자 추가
* 다른 입력 함수와 다른 점
    - fscanf와 달리, 공백, 탭 문자를 만나도 계속 읽음
    - 개행 문자도 문자열에 저장

&ensp;fgets() 함수 사용 예<br/>
&ensp;fgets(str1, 20, fp);<br/>
&ensp;중간에 개행 문자를 만나 읽기 종료, 마지막에 널 문자 추가<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-24.png" width="600"></p>

&ensp;2. fgets(str2, 20, fp);<br/>
&ensp;19개의 문자를 읽은 후 뒤에 널 문자를 합쳐 str2 배열에 저장<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-25.png" width="600"></p>

&ensp;3. fgets(str3, 20, fp);<br/>
&ensp;이전에 읽은 곳 다음부터 읽다가 19개의 문자를 읽기 전에 개행 문자를 읽게 되어 그 뒤에 널 문자를 합쳐 str3 배열에 저장<br/>
<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-26.png" width="600"></p>

&ensp;문자열 단위의 파일 출력 함수: fputs()<br/>
* 파일에 문자열을 출력하는 함수
* 문자열의 끝을 나타내는 널 문자는 파일에 쓰지 않으며 그 뒤에 개행 문자도 자동으로 들어가지 않음 (비교: put()함수는 문자열 출력 후 자동으로 개행)

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-27.png" width="600"></p>

&ensp;표준입력으로부터 국가명을 입력 받고, 이를 Cnty_list.txt 파일에 저장, Cnty_list.txt 파일의 내용을 화면에 문자열 단위로 출력<br/>

```c
char fname[] = "Cnty_list.txt", temp[50] = { '\0' };
FILE *fp = fopen(fname, "w"); // 출력 파일 열기
...
for (i = 0; i < 4; i++) {
fgets(temp, 50, stdin); // 문자열을 입력받아 temp에 저장
fputs(temp, fp); // temp에 저장된 문자열을 파일에 출력
}
fclose(fp); // 출력 파일 닫기
fp = fopen(fname, "r"); // 입력 파일 열기
...
for (i = 0; i < 4; i++) {
fgets(temp, 50, fp); // 입력파일로부터 문자를 읽어 temp에 저장
printf("%s", temp); // temp에 저장된 문자열을 모니터로 출력
}
fclose(fp); // 입력 파일 닫기
```

&ensp;파일의 끝 확인하기: feof( )<br/>
* 파일의 끝까지 데이터를 모두 읽어 들인 상태인지를 확인<br/>

<p align="center"><img src="/assets/img/C Progrmming and Lab/14장 파일 입출력/14-28.png" width="600"></p>

&ensp;EOF (End Of File)란?<br/>
* 파일의 끝을 표현하기 위해 정의해 놓은 상수 (-1)
* EOF도 파일의 내용으로 간주되므로 주의

&ensp;EOF vs. feof( ) 함수<br/>
* 모든 파일의 끝에는 EOF가 존재 -> EOF는 파일의 한 부분임
* feof() 함수는 EOF를 읽으면 0을 반환
* 그 이후에 0이 아닌 값을 반환

&ensp; 파일로부터 데이터를 먼저 읽은 후에 feof() 함수 사용<br/>
